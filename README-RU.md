# Universo Platformo Laravel

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PHP Version](https://img.shields.io/badge/PHP-8.2%2B-blue.svg)](https://www.php.net/)
[![Laravel](https://img.shields.io/badge/Laravel-11.x-red.svg)](https://laravel.com/)
[![Vue.js](https://img.shields.io/badge/Vue-3.x-brightgreen.svg)](https://vuejs.org/)

**Реализация Universo Platformo / Universo MMOOMM / Universo Kiberplano на базе Laravel и связанных технологий PHP.**

> **Примечание:** Это реализация Universo Platformo на Laravel/PHP. Для версии на React/TypeScript см. [universo-platformo-react](https://github.com/teknokomo/universo-platformo-react).

Universo Platformo Laravel — комплексная платформа для создания многопользовательских 3D/AR/VR-приложений, метавселенных и интерактивных цифровых миров. Реализация использует надёжную экосистему Laravel и зрелый инструментарий PHP, обеспечивая масштабируемый бэкенд и одностраничное приложение на Vue.js в качестве фронтенда.

**Universo Platformo служит основой для реализации Universo Kiberplano** — глобальной системы планирования и исполнения, объединяющей планы, задачи и ресурсы с управлением роботами. Система создаёт комплексный фреймворк для всемирной координации усилий, оптимизации распределения ресурсов и эффективной автоматизации через робототехнику в рамках единой цифровой среды.

## Видение и цель

Наш замечательный проект, который поможет создать глобальную технокомизацию и спасти человечество от окончательного порабощения и полного уничтожения, в настоящее время находится на ранней стадии разработки. Мы реализуем версию Universo Platformo на Laravel — основу для создания интерактивных 3D/AR/VR-приложений с надёжностью и масштабируемостью корпоративного уровня.

Более подробно обо всём этом написано в «Книге Будущего» и других наших материалах, большинство из которых пока плохо структурированы и не на английском языке, но уже ведётся работа по созданию новой подробной документации на многих языках.

## Контактная информация

По вопросам или для сотрудничества обращайтесь:

- VK: [https://vk.com/vladimirlevadnij](https://vk.com/vladimirlevadnij)
- Telegram: [https://t.me/Vladimir_Levadnij](https://t.me/Vladimir_Levadnij)
- Email: [universo.pro@yandex.com](mailto:universo.pro@yandex.com)

Наш сайт: [https://universo.pro](https://universo.pro)

## Обзор

Universo Platformo Laravel предоставляет:

- **Архитектура монорепозитория**: Организованная структура пакетов с суффиксами `-frt` (фронтенд) и `-srv` (бэкенд)
- **Фронтенд SPA на Vue.js**: Современное одностраничное приложение на Vue 3 и Vite
- **Безопасный прокси аутентификации Supabase**: Аутентификация Supabase обрабатывается только на сервере — браузер не обращается к Supabase напрямую
- **Сессионная аутентификация**: Серверные сессии Laravel хранят токены в httpOnly-куках
- **Стартовые страницы**: Посадочная страница для гостей и мастер онбординга для авторизованных
- **Двуязычная документация**: Полная документация на английском и русском языках
- **Модульная структура**: Пакеты, организованные по функциональности с чётким разделением ответственности

## Текущий статус

**Фаза проекта**: Реализация стартовых страниц и аутентификации

**Реализованные функции**:
- Гостевая стартовая страница (посадочная страница для неавторизованных пользователей)
- Страница аутентификации (формы входа и регистрации)
- Прокси аутентификации Supabase через Laravel-бэкенд
- Авторизованная стартовая страница с пошаговым мастером онбординга
- Серверное управление сессиями; необработанные токены никогда не поступают в браузер

## Технологический стек

### Бэкенд
- PHP 8.2+
- Laravel 11.x
- Guzzle HTTP Client (прокси Supabase Auth API)
- Laravel Session (серверное хранение токенов через httpOnly-куки)
- Composer для управления зависимостями

### Фронтенд
- Vue.js 3.x (Composition API, `<script setup>`)
- Vite (сборка ресурсов с горячей перезагрузкой через laravel-vite-plugin)
- Axios (HTTP-клиент, автоматически отправляет CSRF-токен)
- Пользовательский CSS (стилизованные компоненты scoped, без UI-фреймворков)

### Аутентификация
- Supabase Auth REST API (проксируется исключительно через Laravel-бэкенд)
- Laravel session driver (httpOnly-куки, серверное хранение токенов)
- CSRF-защита для всех изменяющих состояние запросов

### База данных
- Supabase (PostgreSQL, основная база данных)
- Абстрагирована для будущей поддержки нескольких СУБД

### Инструменты разработки
- Composer для PHP-пакетов
- Node.js / NPM для ресурсов фронтенда
- PHPUnit для тестирования бэкенда
- Laravel Sail для Docker-разработки (опционально)

## Структура проекта

```
universo-platformo-laravel/
├── packages/                          # Все пакеты функциональности
│   ├── start-frt/                     # Фронтенд-пакет стартовых страниц
│   │   ├── base/resources/js/
│   │   │   ├── App.vue                # Корневой компонент; провайдер аутентификации
│   │   │   ├── Pages/                 # GuestStartPage, AuthPage и др.
│   │   │   ├── Components/            # AppAppBar, Hero, Testimonials и др.
│   │   │   ├── Composables/           # useAuth.js, useI18n.js
│   │   │   └── api/                   # API-клиент onboarding.js
│   │   ├── README.md
│   │   └── README-RU.md
│   └── start-srv/                     # Бэкенд-пакет стартовых страниц
│       ├── base/src/
│       │   ├── Controllers/           # AuthController
│       │   ├── Services/              # SupabaseAuthService
│       │   └── Providers/             # StartServiceProvider
│       ├── README.md
│       └── README-RU.md
├── resources/
│   ├── css/app.css                    # Глобальные стили
│   ├── js/app.js                      # Точка входа Vue-приложения
│   ├── lang/en/landing.php            # Строки переводов (i18n)
│   └── views/welcome.blade.php        # HTML-оболочка SPA с CSRF + i18n
├── routes/
│   ├── web.php                        # Catch-all маршрут SPA
│   └── api.php                        # Корневой файл API-маршрутов
├── config/services.php                # Конфигурация учётных данных Supabase
├── tests/                             # Наборы тестов бэкенда
├── .env.example                       # Шаблон конфигурации окружения
├── composer.json                      # PHP-зависимости
├── package.json                       # Node.js-зависимости
├── vite.config.js                     # Конфигурация Vite + плагин Vue
└── README.md                          # Этот файл
```

### Соглашение об именовании пакетов

Пакеты следуют единому шаблону именования:

- **Пакеты фронтенда**: `{имя-функции}-frt` (например, `start-frt`, `clusters-frt`)
- **Пакеты бэкенда**: `{имя-функции}-srv` (например, `start-srv`, `clusters-srv`)

Каждый пакет содержит подкаталог `base/` для базовой реализации, что позволяет создавать альтернативные реализации в будущем.

## Архитектура аутентификации

Всё взаимодействие с Supabase происходит исключительно через Laravel-бэкенд. Браузер никогда не хранит учётные данные Supabase или необработанные токены авторизации.

```
Браузер (Vue SPA)        Laravel Бэкенд            Supabase
      │                        │                      │
      │  POST /api/v1/auth/login│                      │
      │ ──────────────────────► │                      │
      │                        │  POST /auth/v1/token  │
      │                        │ ────────────────────► │
      │                        │ ◄──────────────────── │
      │                        │   токены + данные     │
      │                        │                      │
      │                        │  Сохранить в сессии   │
      │                        │  (httpOnly-кука)      │
      │                        │                      │
      │  {user, authenticated} │                      │
      │ ◄────────────────────── │                      │
```

Токены Supabase хранятся в сессии Laravel и никогда не передаются в браузер. Фронтенд получает только данные пользователя и булевый флаг `authenticated`.

## API-эндпоинты

Все маршруты аутентификации имеют префикс `/api/v1/auth`.

| Метод  | Путь                    | Описание                            |
|--------|-------------------------|-------------------------------------|
| `POST` | `/api/v1/auth/login`    | Вход с email и паролем              |
| `POST` | `/api/v1/auth/register` | Регистрация нового аккаунта         |
| `POST` | `/api/v1/auth/logout`   | Выход и очистка сессии              |
| `GET`  | `/api/v1/auth/user`     | Получение текущего пользователя    |
| `POST` | `/api/v1/auth/refresh`  | Обновление сессии (внутреннее)      |

## Начало работы

### Предварительные требования

- PHP 8.2 или выше
- Composer 2.x
- Node.js 18+ и NPM
- Проект Supabase (для функций аутентификации)

### Установка

1. **Клонируйте репозиторий**

```bash
git clone https://github.com/teknokomo/universo-platformo-laravel.git
cd universo-platformo-laravel
```

2. **Установите PHP-зависимости**

```bash
composer install
```

3. **Установите Node.js-зависимости**

```bash
npm install
```

4. **Настройте переменные окружения**

```bash
cp .env.example .env
php artisan key:generate
```

5. **Настройте учётные данные Supabase**

Отредактируйте `.env`, указав данные вашего проекта Supabase:

```env
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-anon-key
SUPABASE_SERVICE_KEY=your-supabase-service-key
```

6. **Соберите ресурсы фронтенда**

```bash
npm run build
```

7. **Запустите сервер разработки**

```bash
php artisan serve
```

Приложение будет доступно по адресу `http://localhost:8000`

### Рабочий процесс разработки

1. **Создайте новый пакет**
   - Создайте каталог в `packages/` согласно соглашению об именовании
   - Добавьте подкаталог `base/` для реализации
   - Создайте `composer.json` пакета при необходимости
   - Зарегистрируйте пакет в корневом `composer.json`

2. **Добавьте двуязычную документацию**
   - Создайте `README.md` на английском языке
   - Создайте `README-RU.md` на русском (идентичная структура)
   - Синхронизируйте количество строк и разделы

3. **Следуйте лучшим практикам Laravel**
   - Используйте правильную MVC-структуру с сервисным слоем
   - Реализуйте бизнес-логику в выделенных сервисных классах
   - Пишите PHPUnit-тесты для новых функций
   - Соблюдайте стандарты кодирования PSR-12

## Кросс-платформенные реализации

Universo Platformo разрабатывается на нескольких технологических стеках:

- **Laravel**: Этот репозиторий реализует Universo Platformo на Laravel и PHP (текущий)
- **React**: [Universo Platformo React](https://github.com/teknokomo/universo-platformo-react) — реализация на React и TypeScript
- **Godot**: [Universo Platformo Godot](https://github.com/teknokomo/universo-platformo-godot) — реализация на движке Godot
- **PlayCanvas**: [Universo Platformo Nebulo](https://github.com/teknokomo/universo-platformo-nebulo) — реализация на движке PlayCanvas

Каждая реализация разделяет одни концепции и цели, используя преимущества своего технологического стека.

## Участие в разработке

Мы приветствуем вклад! Пожалуйста, следуйте этим рекомендациям:

1. **Создавайте Issue**: Используйте GitHub Issues с двуязычным содержимым (английский с русским в спойлер-тегах)
2. **Следуйте руководствам**: Подробные руководства в `.github/instructions/`:
   - `github-issues.md` — рекомендации по созданию Issue
   - `github-pr.md` — рекомендации по Pull Request
   - `github-labels.md` — рекомендации по использованию меток
   - `i18n-docs.md` — рекомендации по двуязычной документации

3. **Стандарты кода**: Соблюдайте соглашения Laravel и стандарты PSR-12
4. **Тестирование**: Пишите тесты для новых функций
5. **Документация**: Обновляйте документацию при любых изменениях

## Лицензия

Этот проект лицензирован под лицензией MIT — см. файл [LICENSE](LICENSE) для подробностей.

## Благодарности

- Создано с [Laravel](https://laravel.com/) и [Vue.js](https://vuejs.org/)
- Аутентификация через [Supabase](https://supabase.com/) (только на стороне сервера)
- Вдохновлено [Universo Platformo React](https://github.com/teknokomo/universo-platformo-react)
- Ресурсы собраны с помощью [Vite](https://vitejs.dev/)

## Дорожная карта

- [x] Структура репозитория и фундамент
- [x] Стартовые страницы: гостевая, страница аутентификации, онбординг
- [x] Прокси аутентификации Supabase через Laravel-бэкенд
- [x] Vue.js SPA с серверной сессионной аутентификацией (токены не попадают в браузер)
- [ ] Функциональность кластеров (трёхуровневая система сущностей)
- [ ] Функциональность метавселенных
- [ ] Функциональность уников (юнитов)
- [ ] Пространства и холсты с системой узлов
- [ ] Система публикации
- [ ] Расширение поддержки нескольких языков
- [ ] Документация API
- [ ] Комплексное покрытие тестами

---

**Примечание**: Этот проект находится в активной разработке. Структура и функции постоянно совершенствуются на основе эталонной реализации [universo-platformo-react](https://github.com/teknokomo/universo-platformo-react) с соблюдением лучших практик Laravel.
